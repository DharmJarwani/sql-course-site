<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>SQL – GROUP BY Clause</title>

  <!-- common stylesheet -->
  <link rel="stylesheet" href="../css/topic.css" />
</head>
<body>
  <!-- HEADER -->
  <header class="fade-in">
    <h1>GROUP BY – Aggregate Your Data</h1>
    <p class="subtitle">
      Summarise rows into meaningful buckets using COUNT, SUM, AVG, etc.
    </p>
  </header>

 <!-- USE-CASE -->
<section class="card fade-in">
  <h2>When do we use <code>GROUP&nbsp;BY</code>?</h2>
  <p>Use <code>GROUP BY</code> to organize rows into groups that share the same values in one or more columns — typically for applying aggregate functions like <code>COUNT</code>, <code>SUM</code>, or <code>AVG</code> to each group.</p>
  <hr />
  <p><strong>For example, in the Northwind database:</strong></p>
  <ul class="use-cases">
    <li>Sales totals per customer or country</li>
    <li>Average freight, price or discounts</li>
    <li>Dashboards &amp; KPI trend charts</li>
  </ul>
</section>


  <!-- GENERIC SYNTAX + Copy -->
  <section class="card fade-in">
    <h2>Typical GROUP BY Pattern</h2>

    <div class="code-wrap">
<pre id="sql0" class="code-sql"><span class="kw">SELECT</span>  <span class="id">column_to_group</span>,
        <span class="fn">AGG_FUNC</span>(<span class="id">column_to_aggregate</span>) <span class="kw">AS</span> <span class="id">alias</span>
<span class="kw">FROM</span>    <span class="tb">table_name</span>
<span class="kw">GROUP BY</span> <span class="id">column_to_group</span>;
</pre>
      <button class="copy-btn" data-target="sql0">Copy</button>
    </div>
  </section>

  <!-- ========== EXAMPLE 1 ========== -->
  <section class="card fade-in">
    <h2>Example&nbsp;1 – Orders&nbsp;per&nbsp;Customer</h2>

    <div class="code-wrap mini">
<pre id="sql1" class="code-sql"><span class="kw">SELECT</span> <span class="id">CustomerID</span>,
       <span class="kw">COUNT</span>(<span class="id">OrderID</span>) <span class="kw">AS</span> <span class="id">TotalOrders</span>
<span class="kw">FROM</span>   <span class="tb">Orders</span>
<span class="kw">GROUP BY</span> <span class="id">CustomerID</span>;
</pre>
      <button class="copy-btn" data-target="sql1">Copy</button>
    </div>

    <table class="sql-table">
      <thead><tr><th>CustomerID</th><th>TotalOrders</th></tr></thead>
      <tbody>
        <tr><td>ALFKI</td><td>2</td></tr>
        <tr><td>ANATR</td><td>1</td></tr>
      </tbody>
    </table>
  </section>

  <!-- ========== EXAMPLE 2 ========== -->
  <section class="card fade-in">
    <h2>Example&nbsp;2 – Orders by Ship&nbsp;Country</h2>

    <div class="code-wrap mini">
<pre id="sql2" class="code-sql"><span class="kw">SELECT</span> <span class="id">ShipCountry</span>,
       <span class="kw">COUNT</span>(*) <span class="kw">AS</span> <span class="id">OrdersCount</span>
<span class="kw">FROM</span>   <span class="tb">Orders</span>
<span class="kw">GROUP BY</span> <span class="id">ShipCountry</span>;
</pre>
      <button class="copy-btn" data-target="sql2">Copy</button>
    </div>

    <table class="sql-table">
      <thead><tr><th>ShipCountry</th><th>OrdersCount</th></tr></thead>
      <tbody>
        <tr><td>USA</td><td>122</td></tr>
        <tr><td>Germany</td><td>106</td></tr>
      </tbody>
    </table>
  </section>

  <!-- ========== EXAMPLE 3 ========== -->
  <section class="card fade-in">
    <h2>Example&nbsp;3 – Avg&nbsp;Freight per Ship&nbsp;Country</h2>

    <div class="code-wrap mini">
<pre id="sql3" class="code-sql"><span class="kw">SELECT</span> <span class="id">ShipCountry</span>,
       <span class="kw">AVG</span>(<span class="id">Freight</span>) <span class="kw">AS</span> <span class="id">AvgFreight</span>
<span class="kw">FROM</span>   <span class="tb">Orders</span>
<span class="kw">GROUP BY</span> <span class="id">ShipCountry</span>;
</pre>
      <button class="copy-btn" data-target="sql3">Copy</button>
    </div>

    <table class="sql-table">
      <thead><tr><th>ShipCountry</th><th>AvgFreight</th></tr></thead>
      <tbody>
        <tr><td>USA</td><td>58.3</td></tr>
        <tr><td>Germany</td><td>36.1</td></tr>
      </tbody>
    </table>
  </section>

  <!-- ========== EXAMPLE 4 ========== -->
  <section class="card fade-in">
    <h2>Example&nbsp;4 – Products in each Category</h2>

    <div class="code-wrap mini">
<pre id="sql4" class="code-sql"><span class="kw">SELECT</span> <span class="id">CategoryID</span>,
       <span class="kw">COUNT</span>(<span class="id">ProductID</span>) <span class="kw">AS</span> <span class="id">Products</span>
<span class="kw">FROM</span>   <span class="tb">Products</span>
<span class="kw">GROUP BY</span> <span class="id">CategoryID</span>;
</pre>
      <button class="copy-btn" data-target="sql4">Copy</button>
    </div>

    <table class="sql-table">
      <thead><tr><th>CategoryID</th><th>Products</th></tr></thead>
      <tbody>
        <tr><td>1</td><td>12</td></tr>
        <tr><td>2</td><td>19</td></tr>
      </tbody>
    </table>
  </section>

  <!-- ========== EXAMPLE 5 ========== -->
  <section class="card fade-in">
    <h2>Example&nbsp;5 – Units Sold per Order</h2>

    <div class="code-wrap mini">
<pre id="sql5" class="code-sql"><span class="kw">SELECT</span> <span class="id">OrderID</span>,
       <span class="kw">SUM</span>(<span class="id">Quantity</span>) <span class="kw">AS</span> <span class="id">TotalUnits</span>
<span class="kw">FROM</span>   <span class="tb">[Order Details]</span>
<span class="kw">GROUP BY</span> <span class="id">OrderID</span>;
</pre>
      <button class="copy-btn" data-target="sql5">Copy</button>
    </div>

    <table class="sql-table">
      <thead><tr><th>OrderID</th><th>TotalUnits</th></tr></thead>
      <tbody>
        <tr><td>10248</td><td>30</td></tr>
        <tr><td>10249</td><td>28</td></tr>
      </tbody>
    </table>
  </section>

  <!-- footer -->
  <footer>Want more? Pick another topic from the sidebar.</footer>

  <!-- COPY SCRIPT -->
  <script>
    document.querySelectorAll('.copy-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        const id = btn.dataset.target;
        const code = document.getElementById(id).innerText.trim();
        navigator.clipboard.writeText(code).then(() => {
          btn.innerText = '✓ Copied';
          setTimeout(() => (btn.innerText = 'Copy'), 1200);
        });
      });
    });
  </script>
</body>
</html>
